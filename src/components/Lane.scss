@import '../sass-globals.scss';

.lane-container {
  display: inline-flex;
  position: relative;

  .lane-expander {
    position: absolute;
    bottom: calc(var(--note-height) * -0.5);
    width: 100%;
    height: var(--note-height);
    background: transparent;
    z-index: 1;

    &.active {
      cursor: ns-resize;
    }
  }

  .keys {
    border-top: 1px solid $lightMediumGray;
    border-bottom: 1px solid $lightMediumGray;
    box-shadow: 2px 0px 3px #cccccc;
    position: sticky;
    left: 0;
    z-index: 1;
    padding-left: 4px;
    cursor: grab;

    &::before {
      content: '';
      width: 4px;
      height: 100%;
      background-color: var(--lane-color);
      position: absolute;
      left: 0;
      top: 0;
      z-index: 2;
    }

    &.grabbing {
      cursor: grabbing;
    }

    .key {
      width: var(--keys-width, 10px);
      height: var(--note-height);
      box-sizing: border-box;
      background: #ffffff;
      position: relative;
      pointer-events: none;

      &.e-key {
        border-bottom: 1px solid $lightBlue;
      }

      &.black-key {
        background: #000000;
      }

      .note-name {
        position: absolute;
        font-size: 14px;
        font-weight: bold;
        color: $darkGray;
        left: -24px;
        pointer-events: none;
        user-select: none;
      }
    }
  }

  .lane {
    height: 100%;
    width: var(--lane-width);
    flex: 0 0 var(--lane-width);
    border: 1px solid $lightGray;
    box-sizing: border-box;
    position: relative;

    .note-lane {
      background: #ffffff;
      box-sizing: border-box;
      width: 100%;
      height: var(--note-height);

      &.e-key {
        border-bottom: 1px solid $lightBlue;
      }

      &.black-key {
        background: $lightBlue;
      }

      &:last-of-type {
        border-bottom: none;
      }
    }
  }

  .empty-measure {
    height: 100%;
    width: var(--eighth-width);
  }

  .ticks {
    position: absolute;
    top: 0;
    left: -1px;
    height: 100%;
    width: 100%;
    display: flex;
    pointer-events: none;

    .tick-measure-num {
      display: none;
    }

    .tick {
      width: var(--eighth-width);
      flex: 0 0 var(--eighth-width);
      height: 100%;
      box-sizing: border-box;
      border-left: 1px solid $lightGray;

      &.minor {
        border-color: $mediumGray;
      }

      &.major {
        border-color: $lightTextGray;
      }

      &:first-of-type {
        border-left: none;
      }
    }
  }

  .notes {
    position: absolute;
    top: 0;
    left: calc(var(--keys-width) + 4px);
    height: 100%;
    width: 100%;
    pointer-events: none;

    .note {
      position: absolute;
      height: var(--note-height);
      background: $blue;
      pointer-events: all;
      box-shadow: 0px 0px 2px lighten($blue, 30%);
      box-sizing: border-box;
      border: 1px solid lighten($blue, 35%);
      cursor: grab;

      &.grabbing {
        cursor: grabbing;
      }

      &:hover {
        background: $blueHover;
      }

      &.no-pointer {
        pointer-events: none;
      }

      $noteDragWidth: 10px;
      .note-drag-right {
        width: $noteDragWidth;
        position: absolute;
        top: -1px;
        right: $noteDragWidth * -0.5;
        height: var(--note-height);
        background: transparent;
        cursor: ew-resize;

        &.outside {
          right: -$noteDragWidth;
        }
      }

      .note-drag-left {
        width: $noteDragWidth;
        position: absolute;
        top: -1px;
        left: $noteDragWidth * -0.5;
        height: var(--note-height);
        background: transparent;
        cursor: ew-resize;

        &.outside {
          left: -$noteDragWidth;
        }
      }

      &.selected {
        border: 2px solid $blue;
        background: lighten($blue, 35%);

        &:hover {
          background: lighten($blue, 30%);
        }

        .note-drag-left,
        .note-drag-right {
          top: -2px;
        }

        .note-drag-right {
          right: $noteDragWidth * -0.5 - 1px;

          &.outside {
            right: -$noteDragWidth - 1px;
          }
        }

        .note-drag-left {
          left: $noteDragWidth * -0.5 - 1px;

          &.outside {
            left: -$noteDragWidth - 1px;
          }
        }
      }
    }
  }

  &.first {
    .tick-measure-num {
      display: block;
      font-size: 10px;
      margin-left: 2px;
      color: $lightTextGray;
    }

    .tick {
      &.major, &.minor {
        height: calc(100% + 10px);
        margin-top: -9px;
      }

      &:first-of-type {
        border-left: 1px solid $lightTextGray;
        height: 9px;
      }
    }
  }
}
